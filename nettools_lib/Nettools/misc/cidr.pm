#!/usr/bin/perl
# $Id: cidr.pm 20095 2009-05-28 19:59:17Z swolfe $
#

package Nettools::misc::cidr;

use strict;
use warnings;

use 5.6.1;
use vars qw( @ISA @EXPORT );
use Exporter;
@ISA    = qw( Exporter );
@EXPORT = qw( netmask2cidr );

my %table = (
    '0.0.0.0'         => 0,
    '128.0.0.0'       => 1,
    '192.0.0.0'       => 2,
    '224.0.0.0'       => 3,
    '240.0.0.0'       => 4,
    '248.0.0.0'       => 5,
    '252.0.0.0'       => 6,
    '254.0.0.0'       => 7,
    '255.0.0.0'       => 8,
    '255.128.0.0'     => 9,
    '255.192.0.0'     => 10,
    '255.224.0.0'     => 11,
    '255.240.0.0'     => 12,
    '255.248.0.0'     => 13,
    '255.252.0.0'     => 14,
    '255.254.0.0'     => 15,
    '255.255.0.0'     => 16,
    '255.255.128.0'   => 17,
    '255.255.192.0'   => 18,
    '255.255.224.0'   => 19,
    '255.255.240.0'   => 20,
    '255.255.248.0'   => 21,
    '255.255.252.0'   => 22,
    '255.255.254.0'   => 23,
    '255.255.255.0'   => 24,
    '255.255.255.128' => 25,
    '255.255.255.192' => 26,
    '255.255.255.224' => 27,
    '255.255.255.240' => 28,
    '255.255.255.248' => 29,
    '255.255.255.252' => 30,
    '255.255.255.254' => 31,
    '255.255.255.255' => 32,
);

sub netmask2cidr {
    my $netmask = shift;

    if (exists $table{$netmask}) {
        return $table{$netmask};
    }

    elsif (($netmask ge 0) && ($netmask le 32)) {
        return $netmask;
    }

    else {
        return undef;
    }    # if
}    # netmask2cidr

return 1;

__END__
